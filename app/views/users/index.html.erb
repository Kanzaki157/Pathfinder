<%#= link_to 'ゲストログイン（閲覧用）', users_guest_sign_in_path, method: :post %>
<div class="top-swiper">
  <div class="swiper-wrapper">
    <div class="swiper-slide"><%= image_tag 'blue_00073.jpg' %></div>
    <div class="swiper-slide"><%= image_tag 'red_00073.jpg' %></div>
    <div class="swiper-slide"><%= image_tag 'yellow_00073.jpg' %></div>
  </div>
</div>
  <%= render 'flash_messages' %>
<div class="container">
  <div class="row">
    <div class="col-3 mt-5">
      <table class="table table-bordered">
        <thead>
          <tr>
            <th>人気イベント</th>
          </tr>
        </thead>
        <tbody>
          <% @popular_events.each do |event| %>
          <tr>
            <td><%= event.representative %> : <%= event.event_favorites.count %> </td>
          </tr>
          <% end %>
        </tbody>
      </table>
    </div>
  <div class="col-9 mt-5">
    <h2 class="center-text">新着イベント</h2>
      <div class="row">
        <% @latest_events.each do |event| %>
      <div class="col-md-4">
        <div class="border-top border-left border-right" style="border-radius: 0.25rem 0.25rem 0 0;">
          <table class="w-100">
            <tr>
              <td style="width:80%">
                <div style="padding: 0.6rem 1.25rem">
                  <%= event.representative %>
                </div>
              </td>
              <td style="width:20%;border-left: solid thin #cccccc;">
                <div style="padding: 0.6rem 1.25rem">
                  abc
                </div>
              </td>
            </tr>
          </table>
        </div>
        <div class="card mb-4" style="border-radius: 0 0 0.25rem 0.25rem;">
          <div class="card-body">
            <div class="card-title"><%= event.representative %></div>
            <p class="card-text">現在の参加者: <%= event.participants.count %></p>
            <%= link_to '詳細を見る', event, class: "card-link" %>
          </div>
        </div>
      </div>
    <% end %>
  </div>
</div>
<% if user_signed_in? %>
<div class="col-4 mt-5">
  <table class="table table-bordered">
    <thead>
      <tr>
        <th>User</th>
        <th>あなたも企画しなせんか？</th>
          </tr>
            </thead>
              <tbody>
                <tr>
                  <td><%= @user.first_name %><%= @user.last_name %></td>
                  <td>
                    <%= link_to "企画する", new_event_path, class: "btn btn-primary" %> 
                  </td>
                </tr>
              </tbody>
            </table>
        </div>
        <% end %>
      </div>
    </div>
    
<% @categories_events.each do |category, events| %>
  <div class="container mt-5">
    <h3 style="background-size: contain; background-repeat: no-repeat; background-image: url('<%= asset_path category + ".jpg" %>');"><%= category %>の新着イベント</h3>
    <!--<div id="scrollable-div" class="d-flex flex-nowrap overflow-auto">-->
    <div class="swiper">
      <div class="swiper-wrapper">
        <% events.each_slice(3) do |event| %>
          <div class="swiper-slide p-5">
            <div class="row">
              <% event.each do |e| %>
                <div class="col-md-4">
                  <div class="card">
                    <div class="card-body">
                      <h5 class="card-title"><%= e.representative %></h5>
                      <p class="card-text">
                        現在の参加者: <%= e.participants.count %>
                      </p>
                    </div>
                    <div class="card-footer">
                      <%= link_to '詳細を見る', e, class: "card-link" %>
                    </div>
                  </div>
                </div>
              <% end %>
            </div>
          </div>
        <% end %>
      </div>
    <!--</div>-->
      <div class="swiper-pagination"></div>
      <div class="swiper-button-prev"></div>
      <div class="swiper-button-next"></div>
    </div>
  </div>
<% end %>

<script>
  const swiper = new Swiper('.swiper', {
    //オプションの設定
    loop: true, //最後までスライドしたら最初の画像に戻る
    autoplay: {
      delay: 4000
    },
    //ページネーション表示の設定
    pagination: { 
      el: '.swiper-pagination', //ページネーションの要素
    },
   
    //ナビゲーションボタン（矢印）表示の設定
    navigation: { 
      nextEl: '.swiper-button-next', //「次へボタン」要素の指定
      prevEl: '.swiper-button-prev', //「前へボタン」要素の指定
    }
  });
  
  const topSwiper = new Swiper('.top-swiper', {
    // Optional parameters
    loop: true,  // loop mode
    autoplay: {
      delay: 1000
    },
    effect: 'fade',
    fadeEffect: {
    crossFade: true
    },
  });
</script>